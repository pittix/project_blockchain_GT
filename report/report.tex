\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{makecell}
\usepackage{glossaries}
\usepackage{textcomp}
\usepackage{xcolor}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

\newacronym{batman}{B.A.T.M.A.N.}{Better Approach To Mobile Adhoc Networking}

\newacronym{rtt}{RTT}{Round Trip Time}
\newacronym{arq}{ARQ}{Automatic Repeat-reQuest}
\newacronym{ne}{NE}{Nash Equilibrium}


\begin{document}

\title{A game-theoretical analysis of BATMAN-adv protocol}

\author{\IEEEauthorblockN{Andrea Pittaro}
\IEEEauthorblockA{\textit{Dipartimento di Ingegneria dell'Informazione} \\
Padova, Italy \\
andrea.pittaro@studenti.unipd.it}
\and
\IEEEauthorblockN{Enrico Lovisotto}
\IEEEauthorblockA{\textit{Dipartimento di Ingegneria dell'Informazione} \\
Padova, Italy \\
enrico.lovisotto@studenti.unipd.it}
}

\maketitle

\begin{abstract}
  In this course project we will show how a de-centralized telecommunication network using the popular \gls{batman} protocol can sustain itself without a central control.

  The basic idea for this kind of systems is to reward collaboration and penalize unwanted selfish behaviour: in this case the former consists in forwarding each others packets and the latter in dropping them.

  We will study, simulate and measure performances of a distributed infrastructure in order to empirically evaluate when collaboration is indeed the best strategy for the nodes to pursue, meaning when it is the game \gls{ne}.
\end{abstract}

\section{Introduction}

% - history\\

\gls{batman} was born in 2007 as a mesh networks protocol that allowed users to create network using their devices as nodes that routes traffic and transmit data to the network.

In 2008 it became \gls{batman}-adv breaking the ISO/OSI stack and exploiting knowledge at layer 2 and 3 to efficiently find paths and route the packets arriving to each node. During these years the protocol evolved and in 2011 became officially supported by the Linux Kernel, allowing all PCs to become a node in the network.

Since then, the protocol was widely tested, thanks to the Freifunk initiative, which aims to create a decentralized WiFi network and reaching all Germany.

\begin{figure}[h]
  \centering
  \includegraphics[width=0.8\linewidth]{figures/logo.pdf}
  \caption{Logo of \gls{batman} project}
  \label{fig:batman_logo}
\end{figure}

\smallskip

% - how does the protocol work: principles

The protocol \gls{batman}-adv creates a network of ad-hoc connections where each node periodically notifies the neighbours of its presence using discovery messages.

Similarly to what is done in traditional distance-vector routing protocols this information will be used to build a local table that associates to each known remote destination to the next hop for the packet to cross.

The peculiar feature of the \gls{batman} protocol is that together with this alive messages the nodes will periodically exchange their own local forwarding scheme. The emerging shared knowledge makes the connected entities aware of the global structure of the network and so the connections are more reliable and resilient to mobile and non-persistent nodes.

In fact, when a node fails other ones can immediately find new paths upon being notified the change of topology.
Conversely, if a node starts acting selfishly, as it disregards forwarding other packets, the network will soon notice its unfair behaviour and will drop all the packets coming from such a non-collaborative source.

While for smaller networks such global table can span the whole set of nodes, for bigger networks fixed gateways could be set in order to reach other parts of the network. This reduces the information required at each node and allows \gls{batman}-adv to run in home routers.

\smallskip

Like every de-centralized protocol, \gls{batman} relies on the contribution of all involved entities in order to sustain itself. Each node plays then a game, choosing between collaboration and egoism: this project aims to assess when the former is preferred to the latter and what kinds of rewards are needed for the players for the wanted behaviour to be the most convenient.

\section{Methodology}

\subsection{Network setup}

In order to study the protocol we decided to take an experimental approach, measuring objective functions of the players in a simulated setting.

As customary in this kind of analysis, a certain number of nodes are scattered uniformly across a square simulation area, as shown in \autoref{fig:nodes}. This allows to change topology simply switching the generator random seed and will be used to validate all our results.

\begin{figure}[h]
  \centering
  \includegraphics[width=\linewidth]{figures/example_graph}
  \caption{Nodes, labeled by their IP, are connected each other wirelessly.}
  \label{fig:nodes}
\end{figure}

Once placed, each couple of close nodes are linked with wireless fully reliable channels, characterized by a \gls{rtt} and a retransmission probability $p_r$, both function of the reciprocal distance.

This assumption on the channel characteristics reduces the model complexity while keeping an decent degree of realism, as \gls{arq} strategies are common practice at all protocol stack levels.

\begin{equation}
  \begin{split}
    p_r & = e^{-\frac{d}{D}} \\
    RTT &= 2 \frac{d}{c_0} + t_{proc}
  \end{split}
\end{equation}

Up to this point of network building, nodes are able to communicate but there are still no users for our infrastructure.
Applications are then randomly setup between couples of nodes, according to a probability coefficient, later called ``app rate''.

These will be the key to measure the quality of the strategy adopted at the \gls{batman} layer.
Regardless of the cooperation or the selfishness of their routing units, which users in fact don't know nor care about, a good node can be easily recognized as the one whose applications are served with a good bitrate to the rest of the network.

\smallskip
Once all details have been defined, the overall communication scenario can be described by messages exchanged in a directed graph made of \gls{batman}, channels and application layers, depicted in \autoref{fig:graph}.

\begin{figure}[h]
  \centering
  \includegraphics[width=\linewidth]{figures/layers_diagram}
  \caption{Abstract graph spanning all logical components of the network.}
  \label{fig:graph}
\end{figure}

\subsection{Expected results}

In order to be as general as possible, our network connects memoryless sources of traffic communicating to each other: the \gls{batman} layer has the goal to serve its users as best as it can. To do so, node have to rely to a certain extent on their neighbours, since not all destinations are reachable in a single hop.

From a game theoretical point of view, two different strategies can be chosen by each layer in order to maximize its objective: either it can collaborate with its own kind, using part of its bandwidth to forward packets of other sources, or selfishly transmit only its own packets.

As we will show in the upcoming \autoref{sec:results}, the protocol is designed in such a way that the altruistic path is more convenient for the nodes to pursue. The collaboration will turn out to be, in fact, a \gls{ne} for the game played between all the connected entities.

We will furthermore analyze in which terms the network can sustain itself when its conditions change, such as a growing fraction of its users are selfish or network conditions degrade.
All the relevant parameters that will be tuned are listed in \autoref{tab:params}.

\renewcommand\theadalign{l}

\begin{table}[]
\resizebox{\linewidth}{!}{%
  \begin{tabular}{@{}lcl@{}}
    \toprule
    Parameter     & Values range & Description                            \\ \midrule
    L             & 100m ÷ 1000m & Network area dimension                 \\
    D             & 100m ÷ 200m  & Distance parameter for $p_r$           \\
    N             & 10 ÷ 100     & Number of nodes                        \\
    selfish\_rate & 0.01 ÷ 0.1   & Fraction of selfish nodes              \\
    app\_rate     & 0.01 ÷ 0.05  & \thead{Fraction of connected \\couples of nodes} \\ \bottomrule
  \end{tabular}%
}
\vspace{0.1cm}
\caption{Relevant parameters for building the network}
\label{tab:params}
\end{table}


% TODO bit of spoilers for results section

\section{Results} \label{sec:results}

% Network performances between fair and unfair users varying
% - percentage of unfair users
% - requested traffic (number and intensity of apps)
% - channel quality

\section{Conclusion}

\bibliography{report}
% \bibliographystyle{IEEEtran}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% fill-column: 90002000
%%% TeX-master: t
%%% End:
